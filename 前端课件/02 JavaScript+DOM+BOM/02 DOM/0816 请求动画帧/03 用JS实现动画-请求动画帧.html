<!DOCTYPE html>
<html lang="zh-CN">
	<head>
		<meta charset="utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" />
		<meta name="author" content="金西振" />
		<title></title>
		<style>
			.outer {
				width: 100px;
				height: 2000px;
				background-color: blue;
				position: relative;
			}
			.box {
				width: 100px;
				height: 100px;
				background-color: red;
				position: absolute;
				left: 0;
				top: 0;
			}
			button {
				position: fixed;
				top: 0;
				left: 0;
				z-index: 100;
			}
		</style>
	</head>
	<body>
		<button>开始动画</button>
		<div class="outer">
			<div class="box"></div>
		</div>
		<script>
			var btn = document.querySelector('button');
			var box = document.querySelector('.box');

			// var left = 0;
			var timer = 0;

			btn.onclick = function () {
				if (timer) {
					return;
				}

				timer = requestAnimationFrame(move);
				function move() {
					// left += 20;
					// box.style.left = left + 'px';
					// if (left >= 600) {
					// 	cancelAnimationFrame(timer);
					// 	timer = null;
					// }

					// 每次运动后left的值会加1，每次运动时获取最新的offsetLeft的值，offsetLeft是一个动态变化的值
					// console.log('运动前：',box.offsetLeft);
					box.style.left = box.offsetLeft + 1 + 'px';
					// console.log('运动后：',box.offsetLeft);

					timer = requestAnimationFrame(move);
					if (box.offsetLeft >= 600) {
						cancelAnimationFrame(timer);
						timer = null;
					}
				}
			};
		</script>
	</body>
</html>
